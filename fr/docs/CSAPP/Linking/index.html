<!doctype html>
<html class="docs-version-current" lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Linking | My resume</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://malaaa.mljlls.tech//fr/docs/CSAPP/Linking"><meta data-rh="true" name="docusaurus_locale" content="fr"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="fr"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linking | My resume"><meta data-rh="true" name="description" content="Traduit le programme d&#x27;exemple d&#x27;un fichier source ASCII en un fichier objet exÃ©cutable."><meta data-rh="true" property="og:description" content="Traduit le programme d&#x27;exemple d&#x27;un fichier source ASCII en un fichier objet exÃ©cutable."><link data-rh="true" rel="icon" href="/fr/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://malaaa.mljlls.tech//fr/docs/CSAPP/Linking"><link data-rh="true" rel="alternate" href="https://malaaa.mljlls.tech//docs/CSAPP/Linking" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://malaaa.mljlls.tech//fr/docs/CSAPP/Linking" hreflang="fr"><link data-rh="true" rel="alternate" href="https://malaaa.mljlls.tech//zh-CN/docs/CSAPP/Linking" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://malaaa.mljlls.tech//docs/CSAPP/Linking" hreflang="x-default"><link rel="stylesheet" href="/fr/assets/css/styles.c87bd900.css">
<link rel="preload" href="/fr/assets/js/runtime~main.304bdfdc.js" as="script">
<link rel="preload" href="/fr/assets/js/main.b430f803.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Passer au contenu principal</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/fr/"><div class="navbar__logo"><img src="/fr/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/fr/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Mon CV</b></a><a class="navbar__item navbar__link navbar__link--active" href="/fr/docs/intro">Mes notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Malaaaa" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>FranÃ§ais</span></span></a><ul class="dropdown__menu"><li><a href="/docs/CSAPP/Linking" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/fr/docs/CSAPP/Linking" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">FranÃ§ais</a></li><li><a href="/zh-CN/docs/CSAPP/Linking" target="_self" rel="noopener noreferrer" class="dropdown__link">ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰</a></li></ul></div><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Basculer entre les modes sombre et clair (actuellement mode lumiÃ¨re)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Faites dÃ©filer vers le haut" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/intro">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/ReadingNote">Livres</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/fr/docs/CSAPP/CSAPPNOTE">CSAPP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/CSAPP/CSAPPNOTE">SystÃ¨mes informatiques</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/CSAPP/Exceptional Control Flow">Flux de contrÃ´le exceptionnel</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/fr/docs/CSAPP/I/O">je</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/fr/docs/CSAPP/Linking">Linking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fr/docs/CSAPP/Network">Network</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/fr/docs/Flutter/">Battement</a><button aria-label="Basculer la catÃ©gorie de la barre latÃ©rale rÃ©ductible &#x27;Battement&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/HomeChain">HomeChain</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" href="/fr/docs/JavaScript/">JavaScript</a><button aria-label="Basculer la catÃ©gorie de la barre latÃ©rale rÃ©ductible &#x27;JavaScript&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/LinuxConfigNote">Noter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/NetworkBS">RÃ©seau informatique de base</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/fr/docs/React/Reminder">RÃ©agir</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/fr/docs/Skill/IDE">CompÃ©tence</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/fr/docs/TypeScript/JstoTs">TypeScript</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/Web-Note">Web notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/fr/docs/docsify">documenter</a></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/fr/">ğŸ </a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">CSAPP</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/fr/docs/CSAPP/Linking">Linking</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">Sur cette page</button></div><div class="theme-doc-markdown markdown"><header><h1>Linking</h1></header><h3 class="anchor anchorWithStickyNavbar_mojV" id="traduit-le-programme-dexemple-dun-fichier-source-ascii-en-un-fichier-objet-exÃ©cutable">Traduit le programme d&#x27;exemple d&#x27;un fichier source ASCII en un fichier objet exÃ©cutable.<a class="hash-link" href="#traduit-le-programme-dexemple-dun-fichier-source-ascii-en-un-fichier-objet-exÃ©cutable" title="Lien direct vers la rubrique">â€‹</a></h3><p><img loading="lazy" alt="img_6.png" src="/fr/assets/images/img_6-ce6a03bde9531a6cbe27f45be64d85e2.png" width="554" height="141"></p><ol><li>PrÃ©processeur CÂ : cpp <!-- -->[autres arguments]<!-- --> hello.c /tmp/main.i</li><li>Compilateur CÂ : cc1 /tmp/hello.i -Og <!-- -->[autres arguments]<!-- --> -o /tmp/hello.s</li><li>assembleur : as <!-- -->[autres arguments]<!-- --> -o /tmp/hello.o /tmp/hello.s</li><li>programme de liaisonÂ : ld -o hello <!-- -->[fichiers d&#x27;objet systÃ¨me et arguments]<!-- --> /tmp/hello.o /libc.a/printf.o</li><li>programme exÃ©cutable : linux&gt; ./hello</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="fichiers-objet">Fichiers objet<a class="hash-link" href="#fichiers-objet" title="Lien direct vers la rubrique">â€‹</a></h3><p>Format exÃ©cutable et connectable (ELF). <img loading="lazy" alt="img_3.png" src="/fr/assets/images/img_3-f6ba88724de654678c793e808d4d1437.png" width="824" height="684"></p><ul><li><p>.text Le code machine du programme compilÃ©.</p></li><li><p>.rodata <strong>DonnÃ©es en lecture seule</strong> telles que les chaÃ®nes de format dans les instructions printf et tables de sauts pour les instructions switch.</p></li><li><p>.data Variables C globales et statiques initialisÃ©es. Les variables C locales sont maintenues Ã  au moment de l&#x27;exÃ©cution sur la pile et n&#x27;apparaissent ni dans les sections .data ni .bss .</p></li><li><p>.bss Variables C globales et statiques non initialisÃ©es, ainsi que toutes les variables globales ou statiques initialisÃ©es Ã  zÃ©ro. Aucun espace n&#x27;a les mÃªmes adresses avec .comment.</p></li><li><p>.symtab Une table de symboles avec des informations sur les fonctions et les variables globales qui sont dÃ©finies et rÃ©fÃ©rencÃ©es dans le programme.</p></li><li><p>.rel Informations de relocalisation</p></li><li><p>.line Un mappage des numÃ©ros de ligne</p></li><li><p>.strtab Une table de chaÃ®nes</p></li><li><p>Fichier objet dÃ©plaÃ§able. Contient du code binaire et des donnÃ©es sous une forme qui peut Ãªtre combinÃ©e avec d&#x27;autres fichiers objets rÃ©adressables au moment de la compilation pour crÃ©er un fichier objet exÃ©cutable.</p></li><li><p>Fichier objet exÃ©cutable. Contient du code binaire et des donnÃ©es sous une forme qui peut Ãªtre copiÃ©e directement dans la mÃ©moire et exÃ©cutÃ©e. <img loading="lazy" alt="img_2.png" src="/fr/assets/images/img_2-7ea081012bfb8ce50223762d38db5d56.png" width="1236" height="694"></p></li><li><p>Fichier objet partagÃ©. Un type spÃ©cial de fichier objet relocalisable qui peut Ãªtre chargÃ© en mÃ©moire et liÃ© dynamiquement, au moment du chargement ou de l&#x27;exÃ©cution.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="symboles">Symboles<a class="hash-link" href="#symboles" title="Lien direct vers la rubrique">â€‹</a></h4><ul><li>Symboles globaux dÃ©finis par le module m et pouvant Ãªtre rÃ©fÃ©rencÃ©s par autres modules. OU rÃ©fÃ©rencÃ© par le module m mais dÃ©fini par un autre module .</li><li>Symboles locaux dÃ©finis et rÃ©fÃ©rencÃ©s exclusivement par le module m.</li></ul><h6 class="anchor anchorWithStickyNavbar_mojV" id="comment-les-Ã©diteurs-de-liens-rÃ©solvent-les-noms-de-symboles-en-double">Comment les Ã©diteurs de liens rÃ©solvent les noms de symboles en double<a class="hash-link" href="#comment-les-Ã©diteurs-de-liens-rÃ©solvent-les-noms-de-symboles-en-double" title="Lien direct vers la rubrique">â€‹</a></h6><p>symboles forts : int i = 1 ; symboles faiblesÂ : int iÂ ; int principal(i =1); int <strong>attribut</strong>((faible)) power2(int x);int power2(int x) <strong>attribut</strong>((faible));extern int <strong>attribut</strong>((faible)) global_var; RÃ¨gle 1. Plusieurs symboles forts portant le mÃªme nom ne sont pas autorisÃ©s. RÃ¨gle 2. Ã‰tant donnÃ© un symbole fort et plusieurs symboles faibles portant le mÃªme nom, choisit le symbole fort. RÃ¨gle 3. Ã‰tant donnÃ© plusieurs symboles faibles portant le mÃªme nom, choisissez l&#x27;un des symboles faibles.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="dÃ©mÃ©nagement">DÃ©mÃ©nagement<a class="hash-link" href="#dÃ©mÃ©nagement" title="Lien direct vers la rubrique">â€‹</a></h4><ol><li><p>DÃ©placement des sections et des dÃ©finitions de symboles. Dans cette Ã©tape, l&#x27;Ã©diteur de liens fusionne toutes les sections du mÃªme type dans une nouvelle section agrÃ©gÃ©e du mÃªme type.</p></li><li><p>DÃ©placement des rÃ©fÃ©rences de symboles dans les sections. Dans cette Ã©tape, l&#x27;Ã©diteur de liens modifie chaque rÃ©fÃ©rence de symbole dans les corps des sections de code et de donnÃ©es afin qu&#x27;ils vers les adresses d&#x27;exÃ©cution correctes.</p></li></ol><p>Les entrÃ©es de relocalisation pour le code sont placÃ©es dans .rel.text. Les entrÃ©es de relocalisation pour les donnÃ©es sont placÃ©es dans .rel.data.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">/*main.c*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void swap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int buf[2] = {1, 2};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int main() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    swap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retour 0Â ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*swap.c*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extern int buf [] ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int *bufp0 = &amp;buf[0] ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">entier *bufp1Â ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void swap() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int temp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bufp1 = &amp;buf[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temp =*bufp0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *bufp0 = *bufp1Â ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    *bufp1 = temp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">malaaa@malaaa-N8xxEP6&gt; gcc -c swap.c -o swap.o//Fichier objet rÃ©adressable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">malaaa@malaaa-N8xxEP6&gt; gcc -c main.c -o main.o//Fichier objet rÃ©adressable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">malaaa@malaaa- N8xxEP6&gt; gcc -g swap.o main.o -o run//Fichier objet exÃ©cutable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">malaaa@malaaa-N8xxEP6&gt; readelf -s swap.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">malaaa@malaaa-N8xxEP6&gt; readelf -s main.o</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>RÃ©sultat</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">swap.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">La table de symboles &#x27;.symtab&#x27; contient 14 entrÃ©es :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Num : Valeur Taille Type Bind Vis Ndx Name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     0 : 0000000000000000 0 NOTYPE LOCAL DEFAULT UND </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     1 : 0000000000000000 0 FILE LOCAL DEFAULT ABS swap.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     2 : 0000000000000000 0000000 0000000000000000 Section locale 1 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     3: 0000000000000000 0 Section Local 3 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     4: 0000000000000000 0 Section Local local 4 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     5: 0000000000000000 0 section locale 5 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     6: 0000000000000000 0 Section Local local 8 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     7: 0000000000000000 0 Section Local local 9 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     8: 000000000000000000 0 section locale 10 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     9: 0000000000000000 0 Section Local Par dÃ©faut 7 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    10: 0000000000000000 0 VOCAL GLOBAL 5 BUFP0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    11: 0000000000000000 0 NOTYPE GLOBAL DEFAULT UND BUF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    12: 0000000000000000 8 Objet Global Par dÃ©faut 4 BUFP1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    13: 0000000000000000 67 FUNC GLOBAL DEFAULT 1 Ã©change</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>buf, æ˜¯ swap.o.symtable çš„ æ¡ ç›®, extern çš„ ç¬¦å·,<strong>åœ¨ Main.O ä¸­ å®šä¹‰!</strong>, ä»¬ä»¬ çœ‹åˆ° ä¸€ä¸ª å…³äº å…¨å±€ æ˜¯ ä» çš„ æ¡ ç›®, å®ƒ ä» .Data ä¸­ åç§» ä¸º 0 å¤„å¼€å§‹çš„ä¸€ä¸ª 8 å­—èŠ‚çš„å·²åˆå§‹åŒ–ç›®æ ‡. \ bufp0ï¼šæ˜¯ swap.o.symtable çš„ æ¡ ç›®, global ç±»å‹ ç¬¦å·, åœ¨ Swap.o ä¸­ å®šä¹‰, ä»¬ çœ‹åˆ° ä¸€ä¸ª å…³äºå…³äº ä»¬ Bufpo çš„ æ¡æ¡ å®ƒ æ˜¯ ä» .Data ä¸­ åç§» ä¸º 0 å¤„ çš„ ä¸€ä¸ª8 çš„ å·² åˆ å§‹åŒ– ç›®æ ‡ ç›®æ ‡ bufp1ï¼šæ˜¯ swap.o.symtabl çš„ æ¡ ç›®, global çš„ ç¬¦å·, åœ¨ Swap.o ä¸­ å®šä¹‰, å®ƒ çš„ 8 å­—èŠ‚ æ•°æ® ç›®æ ‡ åˆ çš„ 8 å­—èŠ‚ æ•°æ® ç›®æ ‡ åˆ çš„ 8 å­—èŠ‚ æ•°æ® (è¦æ±‚ 8 å­—èŠ‚),æœ€ç»ˆå½“è¿™ä¸ªæ¨¡å—è¢«é“¾æ¥æ—¶å®ƒå°†ä½œä¸ºä¸€ä¸ª.bssç›®æ ‡åˆ†é…\ Ã©changeï¼šæ˜¯swap.o.symTableçš„æ¡ç›®, funcç±»å‹çš„ç¬¦å·,åœ¨ä¸­å®šä¹‰swap.o,å®ƒæ˜¯ä¸€ä¸ªä½äº.textä¸­åç§»ä¸ºé›¶å¤„çš„ 67 å­—èŠ‚çš„å‡½æ•°ã€‚ \ tempï¼šä¸å±äºswap.o.symTableæ¡ç›®ï¼Œintç±»å‹çš„ç¬¦å·ï¼Œåœ¨swap.oä¸­å®šä¹‰ï¼Œå±€éƒ¨å˜é‡ä½ä¸æ ˆä½äºæ ˆä½ä¸æ ˆ</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">main.o</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">La table des symboles &#x27;.symtab&#x27; contient 13 entrÃ©es :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Num : Valeur Taille Type Bind Vis Ndx Nom</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0Â : 0000000000000000 0 NOTYPE LOCAL DEFAULT UND</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1Â : 0000000000000000 0 FILE LOCAL DEFAULT ABS main.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2Â : 0000000000000000 0 Section Local Local Par dÃ©faut 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3: 0000000000000000 0 Section Local local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4: 0000000000000000 0 Section Local Local Par dÃ©faut 6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6: 0000000000000000 0 Section Local local 7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7: 0000000000000000 0 Section Local Local 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8: 0000000000000000 0 section locale 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9: 0000000000000000 8 Global d&#x27;objet Par dÃ©faut 3 buf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10: 0000000000000000 25 FUNC GLOBAL 1 MAIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11: 0000000000000000 0 NOTYPEL GLOBAL DEFAULT UND _GLOBAL_OFFSET_TABLE_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">12: 00000000000000 0 NOTYPE GLOBAL DEFAULT UND SWAP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>buf æ˜¯å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡ï¼Œä¸€ä¸ªä½äº.dataèŠ‚ä¸­åç§»ä½0çš„8å­—èŠ‚ç›®æ ‡ã€‚ \ main ä½äº.textèŠ‚ä¸­åç§»ä¸º0çš„25å­—å­—</p><h6 class="anchor anchorWithStickyNavbar_mojV" id="entrÃ©es-de-relocalisation-dobjdump">entrÃ©es de relocalisation d&#x27;objdump<a class="hash-link" href="#entrÃ©es-de-relocalisation-dobjdump" title="Lien direct vers la rubrique">â€‹</a></h6><p><code>objdump -D -r swap.o</code> -d just .text RÃ©sultat</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">swap.o: format de fichier elf64-x86-64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©sassemblage de la section .text:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 &lt;swap&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0: f3 0f 1e fa endbr64 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   4: 55 push %rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   5: 48 89 e5 mov %rsp,%rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   8: 48 8d 05 00 00 00 00 lea 0x0(%rip),%rax # f &lt;swap+0xf&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            b: R_X86_64_PC32 buf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   f: 48 89 05 00 00 00 00 mov %rax,0x0(%rip) # 16 &lt;swap+0x16&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            12 : R_X86_64_PC32 bufp1-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  16: 48 8b 05 00 00 00 00 mov 0x0(%rip),%rax # 1d &lt;swap+0x1d&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            19: R_X86_64_PC32 bufp0-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1d: 8b 00 mov (%rax),%eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1f: 89 45 fc mov    %eax,-0x4(%rbp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  22: 48 8b 15 00 00 00 00 mov 0x0(%rip),%rdx # 29 &lt;swap+0x29&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            25: R_X86_64_PC32 bufp1-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  29: 48 8b 05 00 00 00 00 mov 0x0(%rip),%rax # 30 &lt;swap+0x30&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            2c: R_X86_64_PC32 bufp0-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  30: 8b 12 mov (%rdx),%edx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  32: 89 10 mov    %edx,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  34: 48 8b 05 00 00 00 00 mov 0x0(%rip),%rax # 3b &lt;swap+0x3b&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            37: R_X86_64_PC32 bufp1-0x4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3b: 8b 55 fc mov -0x4(%rbp),%edx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  3e: 89 10 mov    %edx ,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  40Â : 90 nop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  41Â : 5d pop %rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  42Â : c3 retq   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©montage de la section .bssÂ :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 &lt;bufp1&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©montage de la section .data.rel :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 &lt;bufp0&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            0 : R_X86_64_64 buf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©montage de section .comment :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 &lt;.comment&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0Â : 00 47 43 add    %al,0x43(%rdi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   3Â : 43 3a 20 rex.XB cmp (%r8),%spl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   6Â : 28 55 62 sub    %dl,0x62(%rbp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   9Â : 75 6e jne 79 &lt;swap+0x79&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   bÂ : 74 75 je 82 &lt;swap+0x82&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   dÂ : 20 31 et    %dh,(%rcx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fÂ : 30 2e xor    %ch,(%rsi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11Â : 32 2e xor (%rsi),%ch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  13Â : 30 2d 31 33 75 62 xor    %ch,0x62753331(%rip) # 6275334a &lt;swap+0x6275334a&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  19Â : 75 6e jne 89 &lt;swap+0x89&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1bÂ : 74 75 je 92 &lt;swap+0x92&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1dÂ : 31 29 xor    %ebp,(%rcx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1fÂ : 20 31 et    %dh,(%rcx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  21Â : 30 2e xor    %ch,(%rsi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  23Â : 32 2e xor (%rsi),%ch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  25Â :Â 30</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   &gt;%al,(%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;de la section $0x0,%al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   2Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   4Â : 10 00 adc    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   6Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   8Â : 05 00 00 00 47 ajouter $0x47000000,%eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   dÂ : 4e 55 rex.WRX push %rbp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fÂ : 00 02 ajouter    %al,(%rdx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  13Â : c0 04 00 00 rolb $0x0,(%rax,%rax,1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  17: 00 03 ajouter    %al,(%rbx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  19: 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1bÂ : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1dÂ : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©montage de la section .eh_frameÂ :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000000 &lt;.eh_frame&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0Â : 14 00 adc $0x0,%al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   2Â : 00 00 add    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   4Â : 00 00 add    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   6Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   8Â : 01 7a 52 ajouter    %edi,0x52(%rdx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   bÂ : 00 01 ajouter    %al,(%rcx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   dÂ : 78 10 js 1f &lt;. eh_frame+0x1f&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fÂ : 01 1b ajouter    %ebx,(%rbx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  11Â : 0c 07 ou $0x7,%al</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  13Â : 08 90 01 00 00 1c ou     %dl,0x1c000001(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  19Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1bÂ : 00 1c 00 ajouter    %bl,(%rax,%rax,1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  1eÂ : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  20Â : 00 00 ajouter    %al, (%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            20Â : R_X86_64_PC32 .text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  22Â : 00 00 ajouter    %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  24Â : 43 00 00 rex.XB ajouter %al,(%r8)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  27Â : 00 00 ajouter    %al,( %rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  29Â : 45 0e rex.RB (mauvais) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  2bÂ : 10 86 02 43 0d 06 adc    %al,0x60d4302(%rsi)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  31Â : 7a 0c jp 3f &lt;swap+0x3f&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  33Â : 07 (mauvais)  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  34Â : 08 00 ou     %al,(%rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><h4 class="anchor anchorWithStickyNavbar_mojV" id="fichiers-objet-exÃ©cutables">Fichiers objet exÃ©cutables<a class="hash-link" href="#fichiers-objet-exÃ©cutables" title="Lien direct vers la rubrique">â€‹</a></h4><p><img loading="lazy" alt="img_4.png" src="/fr/assets/images/img_4-920357f5483a3c3f2b2dfde382453ae8.png" width="1310" height="680"> Table d&#x27;en-tÃªte de programme <strong>Lecture seule</strong></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="chargement-de-fichiers-dobjets-exÃ©cutables">Chargement de fichiers d&#x27;objets exÃ©cutables<a class="hash-link" href="#chargement-de-fichiers-dobjets-exÃ©cutables" title="Lien direct vers la rubrique">â€‹</a></h4><p>Le chargeur **** copie le code et les donnÃ©es du fichier objet exÃ©cutable du disque dans la mÃ©moire, puis exÃ©cute le programme en sautant Ã  sa premiÃ¨re instruction, ou point d&#x27;entrÃ©e. \ Le segment de code commence Ã  l&#x27;adresse 0x400000, å¯¹äº Linux è€Œ, 0x400000 çš„ ç©ºé—´ é»˜è®¤ ç¨‹åº çš„ ä½œç”¨. èµ·åˆ° ä¿æŠ¤ ç¨‹åº çš„ ä½œç”¨. èµ·åˆ° ä¿æŠ¤ ç¨‹åº å®‰å…¨ ç¨‹åº ç¨‹åº å®‰å…¨ æ“ä½œ ç³»ç»Ÿ ä¿è¯ å› æ­¤ å¤§ é™åº¦ åˆ©ç”¨\ le segment de donnÃ©es.\ le tas.\ le rÃ©servÃ© aux modules partagÃ©s.\ la pile utilisateur. en dessous de la plus grande adresse utilisateur lÃ©gale (2 48 âˆ’ 1) et croÃ®t vers le bas, vers des adresses mÃ©moire plus petites.\ la partie kernel.memory-resident du systÃ¨me d&#x27;exploitation.</p><p><img loading="lazy" alt="img_5.png" src="/fr/assets/images/img_5-1312c575e79c44ef649452c1944c51c6.png" width="1014" height="940"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="liaison-statique">Liaison statique<a class="hash-link" href="#liaison-statique" title="Lien direct vers la rubrique">â€‹</a></h4><ul><li>Symbol resolution.symbolÂ : une fonction, une variable globale ou une variable statique (le modÃ¨le &#x27;main(int i = 0)&#x27; est une instruction)</li><li>Relocation.Les compilateurs et les assembleurs gÃ©nÃ¨rent des sections de code et de donnÃ©es qui commencent Ã  l&#x27;adresse 0.</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="liaison-dynamique">Liaison dynamique<a class="hash-link" href="#liaison-dynamique" title="Lien direct vers la rubrique">â€‹</a></h4><p>Une bibliothÃ¨que partagÃ©e __ est un module objet qui, au moment de l&#x27;exÃ©cution ou du chargement , peut Ãªtre chargÃ© Ã  une adresse mÃ©moire arbitraire et liÃ© Ã  un programme en mÃ©moire . \ Les systÃ¨mes Linux sont indiquÃ©s par le suffixe .so. Les systÃ¨mes d&#x27;exploitation Microsoft font un usage intensif des bibliothÃ¨ques partagÃ©es, qu&#x27;ils appellent DLL.</p><p>Les bibliothÃ¨ques partagÃ©es sont Â« partagÃ©es Â» de deux maniÃ¨res diffÃ©rentes.</p><ol><li>exactement un fichier .so pour une bibliothÃ¨que particuliÃ¨re. Le code et les donnÃ©es sont partagÃ©s par tous les fichiers objets exÃ©cutables qui rÃ©fÃ©rencent la bibliothÃ¨que,</li><li>La section .text en mÃ©moire peut Ãªtre partagÃ©e par diffÃ©rents processus en cours d&#x27;exÃ©cution. <img loading="lazy" alt="img_7.png" src="/fr/assets/images/img_7-3e602ac16c6f7bc20aa75cf5499d068d.png" width="1032" height="866"></li></ol><h5 class="anchor anchorWithStickyNavbar_mojV" id="lÃ©diteur-de-liens-dynamique-termine-ensuite-la-tÃ¢che-de-liaison-en-effectuant-les-dÃ©placements-suivants">L&#x27;Ã©diteur de liens dynamique termine ensuite la tÃ¢che de liaison en effectuant les dÃ©placements suivantsÂ :<a class="hash-link" href="#lÃ©diteur-de-liens-dynamique-termine-ensuite-la-tÃ¢che-de-liaison-en-effectuant-les-dÃ©placements-suivants" title="Lien direct vers la rubrique">â€‹</a></h5><ul><li>DÃ©placer le texte et les donnÃ©es de libc.so dans un segment de mÃ©moire</li><li>DÃ©placer le texte et les donnÃ©es de libvector.so dans un autre segment de mÃ©moire</li><li>DÃ©placer toutes les rÃ©fÃ©rences dans prog2l vers les symboles dÃ©finis par libc.so et libvector.so</li></ul><h5 class="anchor anchorWithStickyNavbar_mojV" id="le-dynamic-linking-est-une-technique-puissante-et-utile-">Le Dynamic Linking est une technique puissante et utile :<a class="hash-link" href="#le-dynamic-linking-est-une-technique-puissante-et-utile-" title="Lien direct vers la rubrique">â€‹</a></h5><ul><li>Distribution de logiciels. utiliser des bibliothÃ¨ques partagÃ©es pour distribuer les mises Ã  jour logicielles.</li><li>Construire des serveurs Web performants. gÃ©nÃ©rer du contenu dynamique en utilisant une approche plus efficace et sophistiquÃ©e basÃ©e sur la liaison dynamique . les requÃªtes ultÃ©rieures peuvent Ãªtre traitÃ©es au prix d&#x27;un simple appel de fonction. fonctions existantes peuvent Ãªtre mises Ã  jour et de nouvelles fonctions peuvent Ãªtre ajoutÃ©es au moment de l&#x27;exÃ©cution, sans arrÃªter le serveur.</li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="code-indÃ©pendant-de-la-position-pic">Code indÃ©pendant de la position (PIC)<a class="hash-link" href="#code-indÃ©pendant-de-la-position-pic" title="Lien direct vers la rubrique">â€‹</a></h4><p>Le code qui peut Ãªtre chargÃ© sans nÃ©cessiter de dÃ©placement est appelÃ© code indÃ©pendant de la position (PIC). Les utilisateurs dirigent les systÃ¨mes de compilation GNU pour gÃ©nÃ©rer du code PIC avec l&#x27;option -fpic de gcc. Les bibliothÃ¨ques partagÃ©es doivent toujours Ãªtre compilÃ©es avec cette option.</p><p>Le gÃ©nÃ¨re Ã©galement une relocalisation. record pour chaque entrÃ©e dans le GOT. <img loading="lazy" alt="img_8.png" src="/fr/assets/images/img_8-2c2e9c5bbe85954467a1e2ea069981b5.png" width="1320" height="568"> ç”±äºå™¨ æ— æ³• çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„éƒ½ åœ¨ æ•°æ® èŠ‚èŠ‚ ä¸­ åˆ›å»º ä¸€ å‡½æ•°å‡½æ•° xxx @ plt, ç„¶å å°† ä¸­è°ƒç”¨ åœ°å€ æ›¿ æ¢ ä»£ç  ä¸­è°ƒç”¨ åœ°å€ æ›¿ æ‰€ä»¥ æ‰€ä»¥ é€šè¿‡ xxx @ xxx @ Plot çš„ æ›´æ›´, ä»¥åŠ æŒ‡å‘ çš„ æ›´. la table de liaison de procÃ©dure (PLT). Si un module objet appelle des fonctions dÃ©finies dans des bibliothÃ¨ques partagÃ©es, il possÃ¨de alors ses propres GOT et PLT. Le GOT fait partie du segment de donnÃ©es. Le PLT fait partie du segment de code. <code>Ã‰tant donnÃ© que addcnt est dÃ©fini par le module libvector.so, le compilateur peut utiliser la distance constante entre le segment de code et le segment de donnÃ©es pour gÃ©nÃ©rer une rÃ©fÃ©rence relative PC directe Ã  addcnt, et ajouter une relocalisation pour permettre Ã  l&#x27;Ã©diteur de liens de construire ce module partagÃ© Parse ce. Cependant, si addcnt est dÃ©fini par un autre module partagÃ©, un accÃ¨s indirect via GOT est requis. Ici, le compilateur choisit la solution la plus gÃ©nÃ©rale, en utilisant GOT pour toutes les rÃ©fÃ©rences.</code>\ <code>objdump -dx prog</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;main&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">%e201028 &lt;z&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 78aÂ : 48 8d 35 7f 08 20 00 lea 0x20087f(%rip),%rsi # 201010 &lt;y&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 791Â : 48 8d 3d 80 08 20 00 lea 0x200880(%rip),%rdi # 201018 &lt;x&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 898 a3 fe ff ff callq 640 &lt;addvec@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 79dÂ : 8b 0d 89 08 20 00 mov 0x200889(%rip),%ecx # 20102c &lt;z+0x4&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7a3Â : 8b 15 7f 08 20 00 mov</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (%rip),%edx # &lt;z&gt;7a9Â : 48 8d 35 a4 00 00 00 lea 0xa4(%rip),%rsi # 854 &lt;_IO_stdin_used+0x4&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7b0Â : bf 01 00 00 00 mov $0x1,%edi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7b5Â : b8 00 00 00 00 mov $0x0 ,%eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7baÂ : e8 91 fe ff ff callq 650 &lt;__printf_chk@plt&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7bfÂ : b8 00 00 00 00 mov $0x0,%eax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7c4Â : 48 83 c4 08 add $0x8,%rsp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7c8Â : c3 retq   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 7c9Â : 0f 1f 80 00 00 00 00 nopl 0x0(%rax)</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>å¯¹ Addvevec å‡½æ•° å’Œ å’Œ å’Œ PRINRF å‡½æ•° çš„ è°ƒç”¨ è½¬åŒ– å¯¹ ADDVEC @ plt å’Œ __ __printf_chk @ plt å‡½æ•° çš„ è°ƒç”¨, è¿™ ä¸¤ å‡½æ•° å‡½æ•° æ˜¯ åœ¨ .Plt ä¸­ çš„, è€Œ .Plt ä¸­ çš„ å†…å®¹ å¦‚ä¸‹ æ‰€</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">DÃ©montage de la section .plt :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000630 &lt;.plt&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 630Â : ff 35 82 09 20 00 pushq 0x200982(%rip) # 200fb8 &lt;_GLOBAL_OFFSET_TABLE_+0x8&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 636Â : ff 25 84 09 20 ) # 200fc0 &lt;_global_offset_table_ + 0x10&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 63c: 0f 1f 40 00 NOPL 0x0 (% Rax)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000640 &lt;addvec@plt&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 640: FF 25 82 09 20 00 JMPQ * 0x200982 (% RIP) # 200fc8 &lt;addvec&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 646: 68 00 00 00 00 pushq 0 $ 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 64B: E9 E0 FF FF FF JMPQ 630 &lt;.PLT&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">000000000000650 &lt;__PRINF_CHK @ PLT&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 650: FF 25 7A 09 20 00 JMPQ * 0x20097A (% RIP) # 200fd0 &lt;__printf_chk @ glibc_2. 3.4&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 656Â : 68 01 00 00 00 pushq $0x1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 65bÂ : e9 d0 ff ff ff jmpq 630 &lt;.plt&gt;</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ä»¬ ä»¬ ç›®æ ‡ çš„ çš„. ä»¬ çš„ çš„. ä»¬ çš„ çš„ çš„.ä¸­ å¯¹åº” çš„ obtenez ä¸­ ä¿å­˜ çš„ åœ°å€. æ¯”å¦‚é¢ ä»¬ä»¬ è°ƒç”¨ addvevec @ plt å‡½æ•° æ—¶ ä¼š ä¼šè¡Œ 0x640 çš„ JMPQ * 0x200982 (% RIP) æŒ‡ä»¤, çš„ 0x200982 å°± æ˜¯é¢ çš„ è·ç¦» å¸¸é‡, ç”¨æ¥ çš„ è·ç¦»è·ç¦»GOT é¡¹, è¿™é‡Œ å¾—åˆ° è®¿é—® çš„ got çš„ åœ°å€ ä¸º 0x200982 + 0x646 = 0x200fc8, è€Œ è¯¥ çš„ got å†…å®¹ æ‰€ <code>0x00200fc0 00000000 0000000000000000000000000000000000000000000000000000 0000000000 .....
</code></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">000000000000000630</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;&gt;FF 35 82 09 20 00 Poussette 0x200982 (% RIP) # 200fb8 &lt;_global_offset_table_ + 0x8&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 636: FF 25 84 09 20 00 JMPQ * 0x200984 (% RIP) # 200fc0 &lt;_global_offset_table_ + 0x10&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 63cÂ : 0f 1f 40 00 nopl 0x0(%rax)</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ä¸­ ä¸€ æ¡æ¡ æ˜¯ å°† åœ°å€ 0x200982 + 0x636 = 0x200fb8 ä½œä¸º å‚æ•° å‹å…¥æ ˆ è½¬ è½¬ 0x200984 + 0x63c = 0x200fc0 å¤„ ä»¬ ä»¬ ä»¬ ä»¬ ä»¬ ä»¬ ä»¬ ä»¬ ä»¬æ‰§ ç›®æ ‡ çš„ å€¼ å¯ çš„ çš„ å€¼ä¼š å¯ çš„ çš„ å€¼ä¼š å¯å¯ è¯¥ çš„ å€¼ä¼š ä¿®æ”¹ è¯¥ çš„ å€¼ä¼šå€¼ä¼š åˆ° è¯¥ çš„ å€¼ä¼š ä¿®æ”¹ è¯¥ çš„ çš„ å€¼ä¼šå€¼ä¼šå€¼ä¼šåˆ°ä»€ä¹ˆå†…å­˜åœ°å€ã€‚é‚£è¯¥å‡½æ•°æ˜¯å¦‚ä½•çŸ¥é“è¦è·å¾—å“ªä¸ªå‡½æ•°çš„åœ°å€ï¼Œä»¥åŠè¦å°†å‡½æ•°åœ°å€ä¿å­˜åˆ°å“ªä¸ªgoté¡½ä¿å­˜åˆ°å“ªä¸ªgoté¡½</p><p>æˆ‘ä»¬è§‚å¯Ÿå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ä¸­ä»¥ä¸‹å…±äº«åº“çš„å‡½æ•°</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">0000000000000640 &lt;addvec@plt&gt;:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 640: FF 25 82 09 20 00 JMPQ * 0x200982 (% RIP) # 200FC8 &lt;addvec&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 646: 68 00 00 00 00 Poussette 0x0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 64B: E9 E0 FF FF FF JMPQ 630 &lt;.PLT&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">000000000000000650 &lt;__printf_chk@plt&gt;Â :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Â 650Â :Â ff 25 7a 09 20&gt;jmpq *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> (%rip) #</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> &lt;630 &lt;.plt&gt;</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç° ç° çš„ ç¬¬ä¸€æ¡ æŒ‡ä»¤ çš„ çš„ çš„ obtient çš„ çš„ ä¸‹ ä¸€ æ¡ çš„ åœ°å€, å½“ å½“ å½“ ä¸€ ä¸€ ä¸€ ä¸€ ä¸€ æ¡ åˆ° ä¸‹ ä¸€Rela.pltçš„ç´¢å¼•</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">La section de relocalisation &#x27;.rela.plt&#x27; Ã  l&#x27;offset 0x5e8 contient 2 entrÃ©es :</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Offset Info Type Sym. Valeur Sym. Nom + Addend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">000000200fc8 000300000007 R_X86_64_JUMP_SLO 000000000000000 addvec + 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">000000200fd0 000500000007 R_X86_64_JUMP_SLO 000000000 __print@printfC40 __0 300000</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>å…¶ä¸­, offset çš„ åœ°å€, sym.name å°± å‡½æ•° çš„ åå­—. æ‰€ä»¥ åŠ¨æ€é“¾æ¥ ç´¢ å¼•å€¼ æ•°æ®ç»„ ä»¥åŠ ä»¥åŠ å…¶ å®šä½ åŠ¨æ€åº“å‡½æ•° ä»¥åŠ ä»¥åŠ å…¶ åœ°å€ ä¿å­˜å“ªä¸ªgoté¡¹ã€‚</p><p>çš„ çš„ Addvevec å‡½æ•° çš„ å†…å­˜ åœ°å€ ä¿å­˜ ä¸‹ æ¬¡ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ å°± å°± è¯¥ è¯¥ è¯¥ è¯¥ è¯¥ èƒ½ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ å†…å­˜å†…å­˜.</p><p>ä»¬ ç° çš„ xxx @ çš„ xxx @ çš„ å‡½æ•° çš„ çš„ çš„ çš„ çš„ çš„ çš„ä¸­ ä¸€ çš„ çš„ å‡½æ•° ä¼š çš„ çš„ å‡½æ•° ä¼š è¯¥ çš„ å‡½æ•° è¯¥ è¯¥ çš„ çš„ çš„ å‡½æ•° æ–¹æ³• æ–¹æ³• çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ çš„ åœ°å€, å¦åˆ™ å¦åˆ™ çš„ çš„ åœ°å€, å¦åˆ™ å¦åˆ™ç”±æ­¤é˜²æ­¢å¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶åŠ è½½æ—¶éœ€è¦å¯¹å¤§é‡çš„å…±äº«åº“çš„åœ°å€è¿›è¡Œé‡å®šä½ã€‚</p><p>æ‰€ æ‰€ è¿° è¦ ä¸­ ä¸­ ä¸­ ä¸­ ä¸­ çš„ å‡½æ•° æ—¶ æ‰§ è¡Œ Call XXX @ PLT, è®¿é—® çš„ å°è£…ï¼š, ç„¶å çš„ å‡½æ•° çš„ çš„ çš„ é¡¹, å¦‚æœ Vous avez é¡¹ èµ‹å€¼ çš„ xxxçš„ çš„ åœ°å€, ä¼š ä¼š è¯¥ è¯¥ è¯¥ ä¼š è°ƒç”¨ è°ƒç”¨<!-- -->[0]<!-- --> è°ƒç”¨ è°ƒç”¨ å®šä½ xxxå®šä¹‰ çš„, ç¼–è¯‘ å™¨ å¯ä»¥ åˆ©ç”¨ ä»£ç  æ®µ å’Œ æ•°æ® æ®µ ä¹‹é—´ ä¸å˜ çš„ è·ç¦», äº§ç”Ÿ å¯¹ addcnt çš„ ç›´æ¥ PC ç›¸å¯¹ å¼•ç”¨, å¹¶ å¢åŠ  ä¸€ä¸ª é‡ å®šä½, è®© é“¾æ¥ å™¨ åœ¨ æ„é€  è¿™ä¸ª å…±äº« æ¨¡å— æ—¶ è§£æ å®ƒ. ä¸è¿‡, å¦‚æœ addcntæ˜¯ç”±å¦ä¸€ä¸ªå…±äº«æ¨¡å—å®šä¹‰çš„,é‚£ä¹ˆå°±éœ€è¦é€šè¿‡GOTè¿›è¡Œé—´æ¥è®¿é—®.åœ¨è¿™é‡Œ,ç¼–è¯‘å™¨é€‰æ‹©é‡‡ç”¨æœ€é€šç”¨çš„è§£å†³æ–¹æ¡ˆ,ä¸ºæ‰€æœ‰çš„å¼•ç”¨ä½¿ç”¨GOT. <img loading="lazy" alt="img_9.png" src="/fr/assets/images/img_9-d1d3c70726ac6a65c9a5585bcc6b97bc.png" width="778" height="932"> Ã‰tape 1. Au lieu d&#x27;appeler directement addvec, le programme appelle PLT<!-- -->[2]<!-- -->, dont est l&#x27;entrÃ©e PLT pour addvec. \ Ã‰tape 2. La premiÃ¨re instruction PLT fait un saut indirect Ã  travers GOT<!-- -->[4]<!-- -->. Puisque chaque entrÃ©e GOT pointe initialement vers la deuxiÃ¨me instruction dans son entrÃ©e PLT correspondante, le saut indirect retransfÃ¨re simplement le contrÃ´le Ã  l&#x27;instruction suivante dans<!-- -->[2]<!-- --> \ Ã‰tape 3. AprÃ¨s avoir poussÃ© un ID pour addvec (0x1) sur la pile, PLT<!-- -->[2]<!-- --> saute Ã  PLT<!-- -->[0]<!-- -->. \ Ã‰tape 4. PLT<!-- -->[0]<!-- --> pousse un argument pour l&#x27;Ã©diteur de liens dynamique indirectement via GOT<!-- -->[1]<!-- --> , puis saute dans l&#x27;Ã©diteur de liens dynamique indirectement via GOT<!-- -->[2]<!-- -->. L&#x27;Ã©diteur de liens dynamique utilise les deux entrÃ©es de la pile pour dÃ©terminer l&#x27;emplacement d&#x27;exÃ©cution d&#x27;addvec, Ã©crase GOT<!-- -->[4]<!-- --> avec cette adresse et passe le contrÃ´le Ã  addvec. <img loading="lazy" alt="img_10.png" src="/fr/assets/images/img_10-e75921c4e5bc39941f7a09e28cb31ce8.png" width="694" height="918"> Ã‰tape 1. Le contrÃ´le passe Ã  PLT<!-- -->[2]<!-- --> comme prÃ©cÃ©demment.\ Ã‰tape 2. Cependant, cette fois, le saut indirect via GOT<!-- -->[4]<!-- --> transfÃ¨re le contrÃ´le directement Ã  addvec.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="interposition-de-bibliothÃ¨que">Interposition de bibliothÃ¨que<a class="hash-link" href="#interposition-de-bibliothÃ¨que" title="Lien direct vers la rubrique">â€‹</a></h4><p>l&#x27;interposition de bibliothÃ¨que, vous permet d&#x27;intercepter les appels aux fonctions de la bibliothÃ¨que partagÃ©e et d&#x27;exÃ©cuter votre propre code Ã  la place.\ <strong>idÃ©e de baseÂ :</strong> Ã©tant donnÃ© une fonction cible sur laquelle interposer, vous crÃ©ez une fonction wrapper dont le prototype est identique Ã  la fonction cible. En utilisant un mÃ©canisme d&#x27;interposition particulier, vous incitez ensuite le systÃ¨me Ã  appeler la fonction wrapper au lieu de la fonction cible. La fonction enveloppe gÃ©nÃ©ralement exÃ©cute sa propre logique, puis appelle la fonction cible et renvoie sa valeur de retour Ã  l&#x27;appelant.</p><p>L&#x27;interposition peut se produire au moment de la compilation, de la liaison ou de l&#x27;exÃ©cution lorsque le programme est chargÃ© et exÃ©cutÃ©. Exemple de programme int.c</p><div class="codeBlockContainer_I0IT language-code/link/interpose/int.c theme-code-block"><div class="codeBlockContent_wNvx code/link/interpose/int.c"><pre tabindex="0" class="prism-code language-code/link/interpose/int.c codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;malloc.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">int main()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int *p = malloc(32);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    libre(p);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retour(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="1-interposition-au-moment-de-la-compilation">1. Interposition au moment de la compilation<a class="hash-link" href="#1-interposition-au-moment-de-la-compilation" title="Lien direct vers la rubrique">â€‹</a></h5><p>Fichier local de malloc.h</p><div class="codeBlockContainer_I0IT language-code/link/interpose/malloc.h theme-code-block"><div class="codeBlockContent_wNvx code/link/interpose/malloc.h"><pre tabindex="0" class="prism-code language-code/link/interpose/malloc.h codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#define malloc(taille) mymalloc(taille)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define free(ptr) myfree(ptr)</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç„¶å ç¼–è¯‘ ç¼–è¯‘.C æ—¶, ä½¿ç”¨ -I ç¼–è¯‘ é€‰é¡¹ é¢„å¤„ç† ä½¿å¾— é¢„å¤„ç† é¢„å¤„ç† çš„ çš„ Malloc.h çš„ MALLALLOC æ··åˆ MYMALLALC æ··åˆ MYMADRE å‡½æ•°. ä»¬ ä»¬ ä»¬ è‡ªå·± å®ç° myMALLOC å’Œ MYMALLOC å‡½æ•°, å…¶ä¸­ éœ€è¦ è°ƒç”¨ çš„ Malloc.h, ç”±äº Malloc.h ä½¿ç”¨ #define æŒ‡ä»¤, ä»¬ä»¬ åé¢ éœ€è¦ Malloc çš„ åœ°æ–¹ è¢« MyMALLOC æ›¿ä»£. è€Œ mymalloc.c ä»£ç ï¼š Fonctions wrapper dans mymalloc.c</p><div class="codeBlockContainer_I0IT language-mymalloc.c theme-code-block"><div class="codeBlockContent_wNvx mymalloc.c"><pre tabindex="0" class="prism-code language-mymalloc.c codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#ifdef COMPILETIME //ç¼–è¯‘é€‰é¡¹æ˜¯COMPILETIME ï¼Œè¿™æ®µä»£ç æ‰ä¼šç¼–è¯‘è¿›å»</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;malloc.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper malloc */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void *mymalloc(size_t size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void *ptr = malloc( Taille);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;malloc(%d)=%p\n&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           (int)taille, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    points de retourÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper gratuite */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void myfree(void *ptr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    free(ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;libre(%p)\n&quot;, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;COMPILETIME\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å¾—åˆ°è¯¥å‡½æ•°çš„å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶mymalloc.o</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -DCOMPILETIME -c mymalloc.c</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç„¶ååœ¨æœ¬åœ°çš„malloc.hä¸­ç»™å‡ºåŒ…è£…å‡½æ•°çš„å‡½æ•°åŸå‹ï¼Œå³</p><div class="codeBlockContainer_I0IT language-code/link/interpose/malloc.h theme-code-block"><div class="codeBlockContent_wNvx code/link/interpose/malloc.h"><pre tabindex="0" class="prism-code language-code/link/interpose/malloc.h codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#define malloc(taille) mymalloc(taille)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define free(ptr) myfree(ptr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void *mymalloc(size_t size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void myfree(void *ptr);</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç„¶åå°±å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è¡Œè¿›è¡Œç¼–è¯‘æ—¶æ‰“æ¡©</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -I. -o intc int.c mymalloc.o</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>æ­¤æ—¶, ç”±äº -i. ç¼–è¯‘ é€‰é¡¹, å¯¹äº Int.c ä¸­ çš„ Malloc.h, é¢„å¤„ç† ä¼š ä» æœç´¢ Malloc.h æ–‡ä»¶, è€Œ æœ¬åœ° Malloc.h æ–‡ä»¶ ä¸­, Malloc å’Œ gratuit é‡å‡½æ•° æˆmymallocå’Œmyfreeå‡½æ•°ï¼Œè€Œè¿™ä¸¤ä¸ªå‡½æ•°åœ¨ä¹‹å‰ç¼–è¯‘å¥½çš„mymalloc.oå¯é‡å®šä½ç›®æ ‡æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶å°±å®Œæˆäº†ç¼–è¯‘æ—¶æ‰“æ¡©ã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">0x558ca12fc2a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0x558ca12fc2a0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COMPILETIME</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ä½¿ç”¨mallocçš„åœ°æ–¹ï¼Œéƒ½è¢«æ›¿æ¢æˆäº†mymallocã€‚</p><div class="codeBlockContainer_I0IT language-int.i theme-code-block"><div class="codeBlockContent_wNvx int.i"><pre tabindex="0" class="prism-code language-int.i codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">void *mymalloc(taille_t taille);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void myfree(void *ptr);</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="2-interposition-de-temps-de-liaison">2. Interposition de temps de liaison<a class="hash-link" href="#2-interposition-de-temps-de-liaison" title="Lien direct vers la rubrique">â€‹</a></h5><p>Linux é™æ€ é“¾æ¥å™¨ ä¹Ÿ ä½¿ç”¨ è¿› é“¾æ¥ ä¸º __ __ __ __ <strong> çš„ </strong> <strong> çš„ çš„ </strong> <strong> çš„ </strong> çš„ çš„ å¼•ç”¨ çš„ çš„ çš„ å¼•ç”¨å¼•ç”¨ä¼šæ›¿æ¢æˆå¯¹<strong>wrap_få‡½æ•°çš„è°ƒç”¨ï¼Œè€Œé€šè¿‡</strong>real_få‡½æ•°æ¥è°ƒç”¨åŸå§‹å‡½æ•°fã€‚ æˆ‘ä»¬å®šä¹‰ä»¥ä¸‹å‡½æ•°</p><div class="codeBlockContainer_I0IT language-mymalloc.c theme-code-block"><div class="codeBlockContent_wNvx mymalloc.c"><pre tabindex="0" class="prism-code language-mymalloc.c codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#ifdef LINKTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void *__real_malloc(size_t size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void __real_free(void *ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper malloc */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void *__wrap_malloc(size_t size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void *ptr = __real_malloc(size); /* Appel libc malloc */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;malloc(%d) = %p\n&quot;, (int)size, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    points de retourÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper libre */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void __wrap_free(void *ptr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    __real_free(ptr); /* Appel libc free */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;free(%p)\n&quot;, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;LINKTIME\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>åŒæ—¶è¿›è¡Œç¼–è¯‘</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -DLINKTIME -Wl,--wrap,malloc -Wl,--wrap,free -o intl int.c mymalloc.c</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ä¹Ÿå¯ä»¥åˆ†å¼€ç¼–è¯‘</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -DLINKTIME -c mymalloc.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -c int.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gcc -Wl,--wrap,malloc -Wl,--wrap,free -o intl int.o mymalloc.o</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>-WL, option æŠŠ æ ‡å¿— æ ‡å¿— ç»™å™¨ .OPtion ä¸­ çš„ æ¯æ¯ä¸ª-Wl,--wrap,gratuitã€‚</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">malloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">0x558ca12fc2a0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0x558ca12fc2a0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">LINKTIME</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç”±, åˆ©ç”¨å™¨ çš„ æ‰“æ¡© æœºåˆ¶, int.c ä¸­ å¯¹ Malloc gratuit å‡½æ•° çš„ è°ƒç”¨, ä¼š å˜æˆ <strong>wrap_malloc å’Œ </strong>wrap_free çš„ è°ƒç”¨. __ __real_malloc å°† è¢« è§£æ çš„ Malloc.</p><p>ç»¼ä¸Šæ‰€è¿°ï¼šæƒ³è¦åœ¨é“¾æ¥æ—¶æ‰“æ¡©ï¼Œæ„å‘³ç€åœ¨å¯¹å¯é‡å®šä½ç›®æ ‡æ–‡ä»¶çš„ç¬¦å·è¿›è¡Œè§£ææ—¶ï¼Œè¿›è¡Œæ›¿æ¢ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="3-interposition-dexÃ©cution">3. Interposition d&#x27;exÃ©cution<a class="hash-link" href="#3-interposition-dexÃ©cution" title="Lien direct vers la rubrique">â€‹</a></h5><p>è¿ çš„ çš„ ld_preload çš„ å‡½æ•° çš„ ld_preload ç¯å¢ƒ ä»¶ çš„LD_PRELOAD est Ã  Â ;</p><div class="codeBlockContainer_I0IT language-mymalloc.c theme-code-block"><div class="codeBlockContent_wNvx mymalloc.c"><pre tabindex="0" class="prism-code language-mymalloc.c codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#ifdef RUNTIME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define _GNU_SOURCE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;stdlib.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;dlfcn.h&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper malloc */è€Œ__real_mallocå°†ä¼šè¢«è§£ææˆçœŸæ­£çš„mallocã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void *malloc(size_t size)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void *(*mallocp)(taille_t taille);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    caractÃ¨res *erreurÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mallocp = dlsym(RTLD_NEXT, &quot;malloc&quot;); /* RÃ©cupÃ¨re l&#x27;adresse de libc malloc */ </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ((error = dlerror()) != NULL) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fputs(error, stderr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sortie(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    car *ptr = mallocp(taille); /* Appel libc malloc */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// printf(&quot;malloc(%d) = %p\n&quot;, (int)size, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    points de retourÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/* fonction wrapper libre */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">void free(void *ptr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void (*freep)(void *) = NULL;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    caractÃ¨res *erreurÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    si (!ptr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    retourÂ ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    librep = dlsym(RTLD_NEXT, &quot;libre&quot;); /* RÃ©cupÃ¨re l&#x27;adresse de libc free */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if ((error = dlerror()) != NULL) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fputs(error, stderr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sortie(1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    librep(ptr); /* Appel libc free */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;free(%p)\n&quot;, ptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printf(&quot;RUNTIME\n&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç„¶åé€šè¿‡ä»¥ä¸‹å‘½ä»¤è¡Œå°†å…¶ç¼–è¯‘æˆå…±äº«åº“</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -DRUNTIME -shared -fpic -o mymalloc.so mymalloc.c -ldl </span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>ç„¶åç¼–è¯‘ï¼Œåœ¨è¿è¡Œæ—¶æŒ‡å®šç¯å¢ƒå˜é‡LD_PRELOAD</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">gcc -o intr int.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">LD_PRELOAD</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;./mymalloc.so&quot;</span><span class="token plain"> ./intr </span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>æ­¤æ—¶è¡Œ åˆ° Malloc å’Œ gratuit å‡½æ•° è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ è°ƒç”¨ çš„ çš„ çš„ å®šä¹‰, è€Œ çš„ å…± äº«åº“, è€Œ myMALLOC.SO ä¸­ å®šä¹‰ è¿™ ä¸¤ ä¸ª ç¬¦å· ä¸ª ä¸ªä¸ª çš„ çš„ çš„ çš„ çš„ æ–¹å¼ çš„ çš„ çš„ æ–¹å¼ çš„ çš„ çš„ æ–¹å¼ çš„ æ–¹å¼ çš„ æ–¹å¼ä¸º çš„ çš„ çš„ çš„ä¸º ä¸­ è·å¾— çš„ å…± äº«åº“ ä¸­ è·å¾—ï¼šçš„ äº«åº“å…± ä¸­ è·å¾—</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx shell"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;./mymalloc.so&quot;</span><span class="token plain"> ./intr </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libre</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0x55a98bc572a0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DURÃ‰E D&#x27;EXÃ‰CUTION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copier le code dans le presse-papiers" class="copyButton_wuS7 clean-btn">Copie</button></div></div><p>Gnu binutils åŒ… æœ‰ æœ‰ å¯ä»¥ å¯ä»¥ å¯ä»¥ å¯ä»¥ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ åœ¨ä¸ª å¹³å°. arï¼šåˆ›å»º é™æ€åº“, åˆ é™¤, åˆ—å‡º å’Œ æå–. cordesï¼šä¸€ä¸ª ç›®æ ‡ çš„ å­—ç¬¦ä¸². bandeï¼šç›®æ ‡ ç›®æ ‡ æ–‡ä»¶ ä¸­ åˆ é™¤ ç¬¦å· ä¿¡æ¯. nmï¼šåˆ—å‡º ä¸€ä¸ª ç›®æ ‡ çš„ ç¬¦å· ä¸­ çš„ ç¬¦å·. Tailleï¼šåˆ—å‡º ç›®æ ‡ æ–‡ä»¶ ä¸­èŠ‚ çš„ åå­—åå­— å¤§å°. LOOTAGEï¼šæ˜¾ç¤º ä¸€ä¸ª ç›®æ ‡ æ–‡ä»¶ çš„å®Œæ•´, åŒ…æ‹¬ elf ä¸­ çš„ æ‰€æœ‰ ä¿¡æ¯. åŒ…å« Taille å’Œ nm çš„ åŠŸèƒ½. objdumpï¼šäºŒè¿›åˆ¶æœ‰ äºŒè¿›åˆ¶æœ‰ äºŒè¿›åˆ¶æœ‰ äºŒè¿›åˆ¶ å·¥ä»¶ ä»¶ ä»¶ å¤§ çš„ ä½œç”¨ ç›®æ ‡ å®ƒ å¤§ çš„ ä½œç”¨ ä¿¡æ¯ .text èŠ‚ä¸­ çš„.äºŒè¿›åˆ¶æŒ‡ä»¤ã€‚ Linux ç³»ç»Ÿä¸ºæ“ä½œå…±äº«åº“è¿˜æä¾›äº† LDD ç¨‹åºï¼š LDD ç¨‹å‡ºä¸€ä¸ªï¼šæ–‡ä»¶åœ¨è¿è¡Œæ—¶æ‰€éœ€æ—¶æ‰€éœ€</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Malaaaa/blog-sample/tree/main/docs/CSAPP/Linking.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Modifier cette page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Navigation dans les pages de documentation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/fr/docs/CSAPP/I/O"><div class="pagination-nav__sublabel">PrÃ©cÃ©dent</div><div class="pagination-nav__label">O</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/fr/docs/CSAPP/Network"><div class="pagination-nav__sublabel">Suivant</div><div class="pagination-nav__label">Network</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#traduit-le-programme-dexemple-dun-fichier-source-ascii-en-un-fichier-objet-exÃ©cutable" class="table-of-contents__link toc-highlight">Traduit le programme d&#39;exemple d&#39;un fichier source ASCII en un fichier objet exÃ©cutable.</a></li><li><a href="#fichiers-objet" class="table-of-contents__link toc-highlight">Fichiers objet</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Malaaaa Site. Construit avec Docusaurus.</div></div></div></footer></div>
<script src="/fr/assets/js/runtime~main.304bdfdc.js"></script>
<script src="/fr/assets/js/main.b430f803.js"></script>
</body>
</html>